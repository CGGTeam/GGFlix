CREATE TABLE sys.syscomments
(
    id int NOT NULL,
    number smallint,
    colid smallint NOT NULL,
    status smallint NOT NULL,
    ctext varbinary(8000),
    texttype smallint,
    language smallint,
    encrypted bit NOT NULL,
    compressed bit NOT NULL,
    text nvarchar(4000)
);
INSERT INTO sys.syscomments (id, number, colid, status, ctext, texttype, language, encrypted, compressed, text) VALUES (917578307, 1, 1, 0, 0x0D000A0009004300520045004100540045002000500052004F004300450044005500520045002000640062006F002E00730070005F007500700067007200610064006400690061006700720061006D0073000D000A000900410053000D000A00090042004500470049004E000D000A00090009004900460020004F0042004A004500430054005F004900440028004E002700640062006F002E007300790073006400690061006700720061006D0073002700290020004900530020004E004F00540020004E0055004C004C000D000A00090009000900720065007400750072006E00200030003B000D000A0009000D000A000900090043005200450041005400450020005400410042004C0045002000640062006F002E007300790073006400690061006700720061006D0073000D000A000900090028000D000A000900090009006E0061006D00650020007300790073006E0061006D00650020004E004F00540020004E0055004C004C002C000D000A000900090009007000720069006E0063006900700061006C005F0069006400200069006E00740020004E004F00540020004E0055004C004C002C0009002D002D0020007700650020006D006100790020006300680061006E0067006500200069007400200074006F002000760061007200620069006E0061007200790028003800350029000D000A000900090009006400690061006700720061006D005F0069006400200069006E00740020005000520049004D0041005200590020004B004500590020004900440045004E0054004900540059002C000D000A00090009000900760065007200730069006F006E00200069006E0074002C000D000A0009000D000A0009000900090064006500660069006E006900740069006F006E002000760061007200620069006E0061007200790028006D006100780029000D000A0009000900090043004F004E00530054005200410049004E005400200055004B005F007000720069006E0063006900700061006C005F006E0061006D006500200055004E0049005100550045000D000A0009000900090028000D000A0009000900090009007000720069006E0063006900700061006C005F00690064002C000D000A0009000900090009006E0061006D0065000D000A0009000900090029000D000A000900090029003B000D000A000D000A000D000A00090009002F002A0020004100640064002000740068006900730020006900660020007700650020006E00650065006400200074006F0020006800610076006500200073006F006D006500200066006F0072006D0020006F006600200065007800740065006E006400650064002000700072006F007000650072007400690065007300200066006F00720020006400690061006700720061006D00730020002A002F000D000A00090009002F002A000D000A00090009004900460020004F0042004A004500430054005F004900440028004E002700640062006F002E007300790073006400690061006700720061006D005F00700072006F0070006500720074006900650073002700290020004900530020004E0055004C004C000D000A000900090042004500470049004E000D000A0009000900090043005200450041005400450020005400410042004C0045002000640062006F002E007300790073006400690061006700720061006D005F00700072006F0070006500720074006900650073000D000A0009000900090028000D000A0009000900090009006400690061006700720061006D005F0069006400200069006E0074002C000D000A0009000900090009006E0061006D00650020007300790073006E0061006D0065002C000D000A000900090009000900760061006C00750065002000760061007200620069006E0061007200790028006D0061007800290020004E004F00540020004E0055004C004C000D000A0009000900090029000D000A000900090045004E0044000D000A00090009002A002F000D000A000D000A00090009004900460020004F0042004A004500430054005F004900440028004E002700640062006F002E0064007400700072006F0070006500720074006900650073002700290020004900530020004E004F00540020004E0055004C004C000D000A000900090062006500670069006E000D000A0009000900090069006E007300650072007400200069006E0074006F002000640062006F002E007300790073006400690061006700720061006D0073000D000A0009000900090028000D000A0009000900090009005B006E0061006D0065005D002C000D000A0009000900090009005B007000720069006E0063006900700061006C005F00690064005D002C000D000A0009000900090009005B00760065007200730069006F006E005D002C000D000A0009000900090009005B0064006500660069006E006900740069006F006E005D000D000A0009000900090029000D000A00090009000900730065006C00650063007400090020000D000A00090009000900090063006F006E00760065007200740028007300790073006E0061006D0065002C002000640067006E006D002E005B007500760061006C00750065005D0029002C000D000A000900090009000900440041005400410042004100530045005F005000520049004E0043004900500041004C005F004900440028004E002700640062006F00270029002C000900090009002D002D002000770069006C006C0020006300680061006E0067006500200074006F002000740068006500200073006900640020006F0066002000730061000D000A00090009000900090030002C0009000900090009000900090009002D002D0020007A00650072006F00200066006F00720020006F006C006400200066006F0072006D00610074002C002000640067006400650066002E005B00760065007200730069006F006E005D002C000D000A000900090009000900640067006400650066002E005B006C00760061006C00750065005D000D000A00090009000900660072006F006D002000640062006F002E005B0064007400700072006F0070006500720074006900650073005D002000640067006E006D000D000A00090009000900090069006E006E006500720020006A006F0069006E002000640062006F002E005B0064007400700072006F0070006500720074006900650073005D002000640067006700640020006F006E00200064006700670064002E005B00700072006F00700065007200740079005D0020003D002000270044007400670053006300680065006D00610047005500490044002700200061006E006400200064006700670064002E005B006F0062006A00650063007400690064005D0020003D002000640067006E006D002E005B006F0062006A00650063007400690064005D0009000D000A00090009000900090069006E006E006500720020006A006F0069006E002000640062006F002E005B0064007400700072006F0070006500720074006900650073005D0020006400670064006500660020006F006E002000640067006400650066002E005B00700072006F00700065007200740079005D0020003D002000270044007400670053006300680065006D00610044004100540041002700200061006E0064002000640067006400650066002E005B006F0062006A00650063007400690064005D0020003D002000640067006E006D002E005B006F0062006A00650063007400690064005D000D000A0009000900090009000D000A00090009000900770068006500720065002000640067006E006D002E005B00700072006F00700065007200740079005D0020003D002000270044007400670053006300680065006D0061004E0041004D0045002700200061006E006400200064006700670064002E005B007500760061006C00750065005D0020006C0069006B00650020004E0027005F00450041003300450036003200360038002D0044003900390038002D0031003100430045002D0039003400350034002D003000300041004100300030004100330046003300360045005F00270020000D000A00090009000900720065007400750072006E00200032003B000D000A000900090065006E0064000D000A0009000900720065007400750072006E00200031003B000D000A00090045004E0044000D000A000900, 2, 0, 0, 0, '
	CREATE PROCEDURE dbo.sp_upgraddiagrams
	AS
	BEGIN
		IF OBJECT_ID(N''dbo.sysdiagrams'') IS NOT NULL
			return 0;
	
		CREATE TABLE dbo.sysdiagrams
		(
			name sysname NOT NULL,
			principal_id int NOT NULL,	-- we may change it to varbinary(85)
			diagram_id int PRIMARY KEY IDENTITY,
			version int,
	
			definition varbinary(max)
			CONSTRAINT UK_principal_name UNIQUE
			(
				principal_id,
				name
			)
		);


		/* Add this if we need to have some form of extended properties for diagrams */
		/*
		IF OBJECT_ID(N''dbo.sysdiagram_properties'') IS NULL
		BEGIN
			CREATE TABLE dbo.sysdiagram_properties
			(
				diagram_id int,
				name sysname,
				value varbinary(max) NOT NULL
			)
		END
		*/

		IF OBJECT_ID(N''dbo.dtproperties'') IS NOT NULL
		begin
			insert into dbo.sysdiagrams
			(
				[name],
				[principal_id],
				[version],
				[definition]
			)
			select	 
				convert(sysname, dgnm.[uvalue]),
				DATABASE_PRINCIPAL_ID(N''dbo''),			-- will change to the sid of sa
				0,							-- zero for old format, dgdef.[version],
				dgdef.[lvalue]
			from dbo.[dtproperties] dgnm
				inner join dbo.[dtproperties] dggd on dggd.[property] = ''DtgSchemaGUID'' and dggd.[objectid] = dgnm.[objectid]	
				inner join dbo.[dtproperties] dgdef on dgdef.[property] = ''DtgSchemaDATA'' and dgdef.[objectid] = dgnm.[objectid]
				
			where dgnm.[property] = ''DtgSchemaNAME'' and dggd.[uvalue] like N''_EA3E6268-D998-11CE-9454-00AA00A3F36E_'' 
			return 2;
		end
		return 1;
	END
	');
INSERT INTO sys.syscomments (id, number, colid, status, ctext, texttype, language, encrypted, compressed, text) VALUES (1013578649, 1, 1, 0, 0x0D000A0009004300520045004100540045002000500052004F004300450044005500520045002000640062006F002E00730070005F00680065006C0070006400690061006700720061006D0073000D000A00090028000D000A000900090040006400690061006700720061006D006E0061006D00650020007300790073006E0061006D00650020003D0020004E0055004C004C002C000D000A000900090040006F0077006E00650072005F0069006400200069006E00740020003D0020004E0055004C004C000D000A00090029000D000A00090057004900540048002000450058004500430055005400450020004100530020004E002700640062006F0027000D000A000900410053000D000A00090042004500470049004E000D000A00090009004400450043004C0041005200450020004000750073006500720020007300790073006E0061006D0065000D000A00090009004400450043004C0041005200450020004000640062006F004C006F00670069006E0020006200690074000D000A000900090045005800450043005500540045002000410053002000430041004C004C00450052003B000D000A0009000900090053004500540020004000750073006500720020003D00200055005300450052005F004E0041004D004500280029003B000D000A0009000900090053004500540020004000640062006F004C006F00670069006E0020003D00200043004F004E00560045005200540028006200690074002C00490053005F004D0045004D0042004500520028002700640062005F006F0077006E00650072002700290029003B000D000A00090009005200450056004500520054003B000D000A0009000900530045004C004500430054000D000A000900090009005B00440061007400610062006100730065005D0020003D002000440042005F004E0041004D004500280029002C000D000A000900090009005B004E0061006D0065005D0020003D0020006E0061006D0065002C000D000A000900090009005B00490044005D0020003D0020006400690061006700720061006D005F00690064002C000D000A000900090009005B004F0077006E00650072005D0020003D00200055005300450052005F004E0041004D00450028007000720069006E0063006900700061006C005F006900640029002C000D000A000900090009005B004F0077006E0065007200490044005D0020003D0020007000720069006E0063006900700061006C005F00690064000D000A0009000900460052004F004D000D000A000900090009007300790073006400690061006700720061006D0073000D000A0009000900570048004500520045000D000A0009000900090028004000640062006F004C006F00670069006E0020003D002000310020004F005200200055005300450052005F004E0041004D00450028007000720069006E0063006900700061006C005F0069006400290020003D002000400075007300650072002900200041004E0044000D000A00090009000900280040006400690061006700720061006D006E0061006D00650020004900530020004E0055004C004C0020004F00520020006E0061006D00650020003D00200040006400690061006700720061006D006E0061006D0065002900200041004E0044000D000A00090009000900280040006F0077006E00650072005F006900640020004900530020004E0055004C004C0020004F00520020007000720069006E0063006900700061006C005F006900640020003D00200040006F0077006E00650072005F006900640029000D000A00090009004F0052004400450052002000420059000D000A0009000900090034002C00200035002C00200031000D000A00090045004E0044000D000A000900, 2, 0, 0, 0, '
	CREATE PROCEDURE dbo.sp_helpdiagrams
	(
		@diagramname sysname = NULL,
		@owner_id int = NULL
	)
	WITH EXECUTE AS N''dbo''
	AS
	BEGIN
		DECLARE @user sysname
		DECLARE @dboLogin bit
		EXECUTE AS CALLER;
			SET @user = USER_NAME();
			SET @dboLogin = CONVERT(bit,IS_MEMBER(''db_owner''));
		REVERT;
		SELECT
			[Database] = DB_NAME(),
			[Name] = name,
			[ID] = diagram_id,
			[Owner] = USER_NAME(principal_id),
			[OwnerID] = principal_id
		FROM
			sysdiagrams
		WHERE
			(@dboLogin = 1 OR USER_NAME(principal_id) = @user) AND
			(@diagramname IS NULL OR name = @diagramname) AND
			(@owner_id IS NULL OR principal_id = @owner_id)
		ORDER BY
			4, 5, 1
	END
	');
INSERT INTO sys.syscomments (id, number, colid, status, ctext, texttype, language, encrypted, compressed, text) VALUES (1029578706, 1, 1, 0, 0x0D000A0009004300520045004100540045002000500052004F004300450044005500520045002000640062006F002E00730070005F00680065006C0070006400690061006700720061006D0064006500660069006E006900740069006F006E000D000A00090028000D000A000900090040006400690061006700720061006D006E0061006D006500200009007300790073006E0061006D0065002C000D000A000900090040006F0077006E00650072005F0069006400090069006E00740009003D0020006E0075006C006C002000090009000D000A00090029000D000A00090057004900540048002000450058004500430055005400450020004100530020004E002700640062006F0027000D000A000900410053000D000A00090042004500470049004E000D000A000900090073006500740020006E006F0063006F0075006E00740020006F006E000D000A000D000A00090009006400650063006C00610072006500200040007400680065004900640020000900090069006E0074000D000A00090009006400650063006C006100720065002000400049007300440062006F0020000900090069006E0074000D000A00090009006400650063006C00610072006500200040004400690061006700490064000900090069006E0074000D000A00090009006400650063006C006100720065002000400055004900440046006F0075006E006400090069006E0074000D000A0009000D000A000900090069006600280040006400690061006700720061006D006E0061006D00650020006900730020006E0075006C006C0029000D000A000900090062006500670069006E000D000A0009000900090052004100490053004500520052004F005200200028004E00270045005F0049004E00560041004C004900440041005200470027002C002000310036002C002000310029003B000D000A00090009000900720065007400750072006E0020002D0031000D000A000900090065006E0064000D000A0009000D000A000900090065007800650063007500740065002000610073002000630061006C006C00650072003B000D000A0009000900730065006C00650063007400200040007400680065004900640020003D002000440041005400410042004100530045005F005000520049004E0043004900500041004C005F0049004400280029003B000D000A0009000900730065006C006500630074002000400049007300440062006F0020003D002000490053005F004D0045004D0042004500520028004E002700640062005F006F0077006E0065007200270029003B000D000A000900090069006600280040006F0077006E00650072005F006900640020006900730020006E0075006C006C0029000D000A00090009000900730065006C00650063007400200040006F0077006E00650072005F006900640020003D0020004000740068006500490064003B000D000A00090009007200650076006500720074003B0020000D000A0009000D000A0009000900730065006C006500630074002000400044006900610067004900640020003D0020006400690061006700720061006D005F00690064002C002000400055004900440046006F0075006E00640020003D0020007000720069006E0063006900700061006C005F00690064002000660072006F006D002000640062006F002E007300790073006400690061006700720061006D00730020007700680065007200650020007000720069006E0063006900700061006C005F006900640020003D00200040006F0077006E00650072005F0069006400200061006E00640020006E0061006D00650020003D00200040006400690061006700720061006D006E0061006D0065003B000D000A0009000900690066002800400044006900610067004900640020004900530020004E0055004C004C0020006F00720020002800400049007300440062006F0020003D0020003000200061006E0064002000400055004900440046006F0075006E00640020003C003E0020004000740068006500490064002000290029000D000A000900090062006500670069006E000D000A0009000900090052004100490053004500520052004F0052002000280027004400690061006700720061006D00200064006F006500730020006E006F00740020006500780069007300740020006F007200200079006F007500200064006F0020006E006F0074002000680061007600650020007000650072006D0069007300730069006F006E002E0027002C002000310036002C002000310029003B000D000A00090009000900720065007400750072006E0020002D0033000D000A000900090065006E0064000D000A000D000A0009000900730065006C006500630074002000760065007200730069006F006E002C00200064006500660069006E006900740069006F006E002000460052004F004D002000640062006F002E007300790073006400690061006700720061006D00730020007700680065007200650020006400690061006700720061006D005F006900640020003D002000400044006900610067004900640020003B0020000D000A0009000900720065007400750072006E00200030000D000A00090045004E0044000D000A000900, 2, 0, 0, 0, '
	CREATE PROCEDURE dbo.sp_helpdiagramdefinition
	(
		@diagramname 	sysname,
		@owner_id	int	= null 		
	)
	WITH EXECUTE AS N''dbo''
	AS
	BEGIN
		set nocount on

		declare @theId 		int
		declare @IsDbo 		int
		declare @DiagId		int
		declare @UIDFound	int
	
		if(@diagramname is null)
		begin
			RAISERROR (N''E_INVALIDARG'', 16, 1);
			return -1
		end
	
		execute as caller;
		select @theId = DATABASE_PRINCIPAL_ID();
		select @IsDbo = IS_MEMBER(N''db_owner'');
		if(@owner_id is null)
			select @owner_id = @theId;
		revert; 
	
		select @DiagId = diagram_id, @UIDFound = principal_id from dbo.sysdiagrams where principal_id = @owner_id and name = @diagramname;
		if(@DiagId IS NULL or (@IsDbo = 0 and @UIDFound <> @theId ))
		begin
			RAISERROR (''Diagram does not exist or you do not have permission.'', 16, 1);
			return -3
		end

		select version, definition FROM dbo.sysdiagrams where diagram_id = @DiagId ; 
		return 0
	END
	');
INSERT INTO sys.syscomments (id, number, colid, status, ctext, texttype, language, encrypted, compressed, text) VALUES (1045578763, 1, 1, 0, 0x0D000A0009004300520045004100540045002000500052004F004300450044005500520045002000640062006F002E00730070005F006300720065006100740065006400690061006700720061006D000D000A00090028000D000A000900090040006400690061006700720061006D006E0061006D006500200009007300790073006E0061006D0065002C000D000A000900090040006F0077006E00650072005F00690064000900090069006E00740009003D0020006E0075006C006C002C00200009000D000A00090009004000760065007200730069006F006E0020000900090069006E0074002C000D000A0009000900400064006500660069006E006900740069006F006E0020000900760061007200620069006E0061007200790028006D006100780029000D000A00090029000D000A00090057004900540048002000450058004500430055005400450020004100530020002700640062006F0027000D000A000900410053000D000A00090042004500470049004E000D000A000900090073006500740020006E006F0063006F0075006E00740020006F006E000D000A0009000D000A00090009006400650063006C006100720065002000400074006800650049006400200069006E0074000D000A00090009006400650063006C0061007200650020004000720065007400760061006C00200069006E0074000D000A00090009006400650063006C006100720065002000400049007300440062006F00090069006E0074000D000A00090009006400650063006C006100720065002000400075007300650072004E0061006D00650020007300790073006E0061006D0065000D000A00090009006900660028004000760065007200730069006F006E0020006900730020006E0075006C006C0020006F007200200040006400690061006700720061006D006E0061006D00650020006900730020006E0075006C006C0029000D000A000900090062006500670069006E000D000A0009000900090052004100490053004500520052004F005200200028004E00270045005F0049004E00560041004C004900440041005200470027002C002000310036002C002000310029003B000D000A00090009000900720065007400750072006E0020002D0031000D000A000900090065006E0064000D000A0009000D000A000900090065007800650063007500740065002000610073002000630061006C006C00650072003B000D000A0009000900730065006C00650063007400200040007400680065004900640020003D002000440041005400410042004100530045005F005000520049004E0043004900500041004C005F0049004400280029003B0020000D000A0009000900730065006C006500630074002000400049007300440062006F0020003D002000490053005F004D0045004D0042004500520028004E002700640062005F006F0077006E0065007200270029003B000D000A00090009007200650076006500720074003B0020000D000A00090009000D000A000900090069006600200040006F0077006E00650072005F006900640020006900730020006E0075006C006C000D000A000900090062006500670069006E000D000A00090009000900730065006C00650063007400200040006F0077006E00650072005F006900640020003D0020004000740068006500490064003B000D000A000900090065006E0064000D000A000900090065006C00730065000D000A000900090062006500670069006E000D000A0009000900090069006600200040007400680065004900640020003C003E00200040006F0077006E00650072005F00690064000D000A0009000900090062006500670069006E000D000A000900090009000900690066002000400049007300440062006F0020003D00200030000D000A00090009000900090062006500670069006E000D000A000900090009000900090052004100490053004500520052004F005200200028004E00270045005F0049004E00560041004C004900440041005200470027002C002000310036002C002000310029003B000D000A0009000900090009000900720065007400750072006E0020002D0031000D000A00090009000900090065006E0064000D000A000900090009000900730065006C00650063007400200040007400680065004900640020003D00200040006F0077006E00650072005F00690064000D000A0009000900090065006E0064000D000A000900090065006E0064000D000A00090009002D002D0020006E006500780074002000320020006C0069006E00650020006F006E006C007900200066006F007200200074006500730074002C002000770069006C006C002000620065002000720065006D006F00760065006400200061006600740065007200200064006500660069006E00650020006E0061006D006500200075006E0069007100750065000D000A00090009006900660020004500580049005300540053002800730065006C0065006300740020006400690061006700720061006D005F00690064002000660072006F006D002000640062006F002E007300790073006400690061006700720061006D00730020007700680065007200650020007000720069006E0063006900700061006C005F006900640020003D002000400074006800650049006400200061006E00640020006E0061006D00650020003D00200040006400690061006700720061006D006E0061006D00650029000D000A000900090062006500670069006E000D000A0009000900090052004100490053004500520052004F00520020002800270054006800650020006E0061006D006500200069007300200061006C0072006500610064007900200075007300650064002E0027002C002000310036002C002000310029003B000D000A00090009000900720065007400750072006E0020002D0032000D000A000900090065006E0064000D000A0009000D000A000900090069006E007300650072007400200069006E0074006F002000640062006F002E007300790073006400690061006700720061006D00730028006E0061006D0065002C0020007000720069006E0063006900700061006C005F006900640020002C002000760065007200730069006F006E002C00200064006500660069006E006900740069006F006E0029000D000A000900090009000900560041004C00550045005300280040006400690061006700720061006D006E0061006D0065002C0020004000740068006500490064002C0020004000760065007200730069006F006E002C002000400064006500660069006E006900740069006F006E00290020003B000D000A00090009000D000A0009000900730065006C0065006300740020004000720065007400760061006C0020003D002000400040004900440045004E00540049005400590020000D000A0009000900720065007400750072006E0020004000720065007400760061006C000D000A00090045004E0044000D000A000900, 2, 0, 0, 0, '
	CREATE PROCEDURE dbo.sp_creatediagram
	(
		@diagramname 	sysname,
		@owner_id		int	= null, 	
		@version 		int,
		@definition 	varbinary(max)
	)
	WITH EXECUTE AS ''dbo''
	AS
	BEGIN
		set nocount on
	
		declare @theId int
		declare @retval int
		declare @IsDbo	int
		declare @userName sysname
		if(@version is null or @diagramname is null)
		begin
			RAISERROR (N''E_INVALIDARG'', 16, 1);
			return -1
		end
	
		execute as caller;
		select @theId = DATABASE_PRINCIPAL_ID(); 
		select @IsDbo = IS_MEMBER(N''db_owner'');
		revert; 
		
		if @owner_id is null
		begin
			select @owner_id = @theId;
		end
		else
		begin
			if @theId <> @owner_id
			begin
				if @IsDbo = 0
				begin
					RAISERROR (N''E_INVALIDARG'', 16, 1);
					return -1
				end
				select @theId = @owner_id
			end
		end
		-- next 2 line only for test, will be removed after define name unique
		if EXISTS(select diagram_id from dbo.sysdiagrams where principal_id = @theId and name = @diagramname)
		begin
			RAISERROR (''The name is already used.'', 16, 1);
			return -2
		end
	
		insert into dbo.sysdiagrams(name, principal_id , version, definition)
				VALUES(@diagramname, @theId, @version, @definition) ;
		
		select @retval = @@IDENTITY 
		return @retval
	END
	');
INSERT INTO sys.syscomments (id, number, colid, status, ctext, texttype, language, encrypted, compressed, text) VALUES (1061578820, 1, 1, 0, 0x0D000A0009004300520045004100540045002000500052004F004300450044005500520045002000640062006F002E00730070005F00720065006E0061006D0065006400690061006700720061006D000D000A00090028000D000A000900090040006400690061006700720061006D006E0061006D0065002000090009007300790073006E0061006D0065002C000D000A000900090040006F0077006E00650072005F00690064000900090069006E00740009003D0020006E0075006C006C002C000D000A000900090040006E00650077005F006400690061006700720061006D006E0061006D00650009007300790073006E0061006D0065000D000A0009000D000A00090029000D000A00090057004900540048002000450058004500430055005400450020004100530020002700640062006F0027000D000A000900410053000D000A00090042004500470049004E000D000A000900090073006500740020006E006F0063006F0075006E00740020006F006E000D000A00090009006400650063006C006100720065002000400074006800650049006400200009000900090069006E0074000D000A00090009006400650063006C006100720065002000400049007300440062006F00200009000900090069006E0074000D000A00090009000D000A00090009006400650063006C006100720065002000400055004900440046006F0075006E00640020000900090069006E0074000D000A00090009006400650063006C006100720065002000400044006900610067004900640009000900090069006E0074000D000A00090009006400650063006C006100720065002000400044006900610067004900640054006100720067000900090069006E0074000D000A00090009006400650063006C006100720065002000400075005F006E0061006D0065000900090009007300790073006E0061006D0065000D000A0009000900690066002800280040006400690061006700720061006D006E0061006D00650020006900730020006E0075006C006C00290020006F0072002000280040006E00650077005F006400690061006700720061006D006E0061006D00650020006900730020006E0075006C006C00290029000D000A000900090062006500670069006E000D000A0009000900090052004100490053004500520052004F00520020002800270049006E00760061006C00690064002000760061006C007500650027002C002000310036002C002000310029003B000D000A00090009000900720065007400750072006E0020002D0031000D000A000900090065006E0064000D000A0009000D000A000900090045005800450043005500540045002000410053002000430041004C004C00450052003B000D000A0009000900730065006C00650063007400200040007400680065004900640020003D002000440041005400410042004100530045005F005000520049004E0043004900500041004C005F0049004400280029003B000D000A0009000900730065006C006500630074002000400049007300440062006F0020003D002000490053005F004D0045004D0042004500520028004E002700640062005F006F0077006E0065007200270029003B0020000D000A000900090069006600280040006F0077006E00650072005F006900640020006900730020006E0075006C006C0029000D000A00090009000900730065006C00650063007400200040006F0077006E00650072005F006900640020003D0020004000740068006500490064003B000D000A00090009005200450056004500520054003B000D000A0009000D000A0009000900730065006C006500630074002000400075005F006E0061006D00650020003D00200055005300450052005F004E0041004D004500280040006F0077006E00650072005F006900640029000D000A0009000D000A0009000900730065006C006500630074002000400044006900610067004900640020003D0020006400690061006700720061006D005F00690064002C002000400055004900440046006F0075006E00640020003D0020007000720069006E0063006900700061006C005F00690064002000660072006F006D002000640062006F002E007300790073006400690061006700720061006D00730020007700680065007200650020007000720069006E0063006900700061006C005F006900640020003D00200040006F0077006E00650072005F0069006400200061006E00640020006E0061006D00650020003D00200040006400690061006700720061006D006E0061006D00650020000D000A0009000900690066002800400044006900610067004900640020004900530020004E0055004C004C0020006F00720020002800400049007300440062006F0020003D0020003000200061006E0064002000400055004900440046006F0075006E00640020003C003E002000400074006800650049006400290029000D000A000900090062006500670069006E000D000A0009000900090052004100490053004500520052004F0052002000280027004400690061006700720061006D00200064006F006500730020006E006F00740020006500780069007300740020006F007200200079006F007500200064006F0020006E006F0074002000680061007600650020007000650072006D0069007300730069006F006E002E0027002C002000310036002C002000310029000D000A00090009000900720065007400750072006E0020002D0033000D000A000900090065006E0064000D000A0009000D000A00090009002D002D0020006900660028002800400075005F006E0061006D00650020006900730020006E006F00740020006E0075006C006C002900200061006E0064002000280040006E00650077005F006400690061006700720061006D006E0061006D00650020003D00200040006400690061006700720061006D006E0061006D0065002900290009002D002D0020006E006F007400680069006E0067002000770069006C006C0020006300680061006E00670065000D000A00090009002D002D000900720065007400750072006E00200030003B000D000A0009000D000A0009000900690066002800400075005F006E0061006D00650020006900730020006E0075006C006C0029000D000A00090009000900730065006C0065006300740020004000440069006100670049006400540061007200670020003D0020006400690061006700720061006D005F00690064002000660072006F006D002000640062006F002E007300790073006400690061006700720061006D00730020007700680065007200650020007000720069006E0063006900700061006C005F006900640020003D002000400074006800650049006400200061006E00640020006E0061006D00650020003D00200040006E00650077005F006400690061006700720061006D006E0061006D0065000D000A000900090065006C00730065000D000A00090009000900730065006C0065006300740020004000440069006100670049006400540061007200670020003D0020006400690061006700720061006D005F00690064002000660072006F006D002000640062006F002E007300790073006400690061006700720061006D00730020007700680065007200650020007000720069006E0063006900700061006C005F006900640020003D00200040006F0077006E00650072005F0069006400200061006E00640020006E0061006D00650020003D00200040006E00650077005F006400690061006700720061006D006E0061006D0065000D000A0009000D000A000900090069006600280028004000440069006100670049006400540061007200670020006900730020006E006F00740020006E0075006C006C002900200061006E00640020002000400044006900610067004900640020003C003E0020004000440069006100670049006400540061007200670029000D000A000900090062006500670069006E000D000A0009000900090052004100490053004500520052004F00520020002800270054006800650020006E0061006D006500200069007300200061006C0072006500610064007900200075007300650064002E0027002C002000310036002C002000310029003B000D000A00090009000900720065007400750072006E0020002D0032000D000A000900090065006E006400090009000D000A0009000D000A0009000900690066002800400075005F006E0061006D00650020006900730020006E0075006C006C0029000D000A000900090009007500700064006100740065002000640062006F002E007300790073006400690061006700720061006D007300200073006500740020005B006E0061006D0065005D0020003D00200040006E00650077005F006400690061006700720061006D006E0061006D0065002C0020007000720069006E0063006900700061006C005F006900640020003D00200040007400680065004900640020007700680065007200650020006400690061006700720061006D005F006900640020003D00200040004400690061006700490064000D000A000900090065006C00730065000D000A000900090009007500700064006100740065002000640062006F002E007300790073006400690061006700720061006D007300200073006500740020005B006E0061006D0065005D0020003D00200040006E00650077005F006400690061006700720061006D006E0061006D00650020007700680065007200650020006400690061006700720061006D005F006900640020003D00200040004400690061006700490064000D000A0009000900720065007400750072006E00200030000D000A00090045004E0044000D000A000900, 2, 0, 0, 0, '
	CREATE PROCEDURE dbo.sp_renamediagram
	(
		@diagramname 		sysname,
		@owner_id		int	= null,
		@new_diagramname	sysname
	
	)
	WITH EXECUTE AS ''dbo''
	AS
	BEGIN
		set nocount on
		declare @theId 			int
		declare @IsDbo 			int
		
		declare @UIDFound 		int
		declare @DiagId			int
		declare @DiagIdTarg		int
		declare @u_name			sysname
		if((@diagramname is null) or (@new_diagramname is null))
		begin
			RAISERROR (''Invalid value'', 16, 1);
			return -1
		end
	
		EXECUTE AS CALLER;
		select @theId = DATABASE_PRINCIPAL_ID();
		select @IsDbo = IS_MEMBER(N''db_owner''); 
		if(@owner_id is null)
			select @owner_id = @theId;
		REVERT;
	
		select @u_name = USER_NAME(@owner_id)
	
		select @DiagId = diagram_id, @UIDFound = principal_id from dbo.sysdiagrams where principal_id = @owner_id and name = @diagramname 
		if(@DiagId IS NULL or (@IsDbo = 0 and @UIDFound <> @theId))
		begin
			RAISERROR (''Diagram does not exist or you do not have permission.'', 16, 1)
			return -3
		end
	
		-- if((@u_name is not null) and (@new_diagramname = @diagramname))	-- nothing will change
		--	return 0;
	
		if(@u_name is null)
			select @DiagIdTarg = diagram_id from dbo.sysdiagrams where principal_id = @theId and name = @new_diagramname
		else
			select @DiagIdTarg = diagram_id from dbo.sysdiagrams where principal_id = @owner_id and name = @new_diagramname
	
		if((@DiagIdTarg is not null) and  @DiagId <> @DiagIdTarg)
		begin
			RAISERROR (''The name is already used.'', 16, 1);
			return -2
		end		
	
		if(@u_name is null)
			update dbo.sysdiagrams set [name] = @new_diagramname, principal_id = @theId where diagram_id = @DiagId
		else
			update dbo.sysdiagrams set [name] = @new_diagramname where diagram_id = @DiagId
		return 0
	END
	');
INSERT INTO sys.syscomments (id, number, colid, status, ctext, texttype, language, encrypted, compressed, text) VALUES (1077578877, 1, 1, 0, 0x0D000A0009004300520045004100540045002000500052004F004300450044005500520045002000640062006F002E00730070005F0061006C007400650072006400690061006700720061006D000D000A00090028000D000A000900090040006400690061006700720061006D006E0061006D006500200009007300790073006E0061006D0065002C000D000A000900090040006F0077006E00650072005F0069006400090069006E00740009003D0020006E0075006C006C002C000D000A00090009004000760065007200730069006F006E002000090069006E0074002C000D000A0009000900400064006500660069006E006900740069006F006E0020000900760061007200620069006E0061007200790028006D006100780029000D000A00090029000D000A00090057004900540048002000450058004500430055005400450020004100530020002700640062006F0027000D000A000900410053000D000A00090042004500470049004E000D000A000900090073006500740020006E006F0063006F0075006E00740020006F006E000D000A0009000D000A00090009006400650063006C006100720065002000400074006800650049006400200009000900090069006E0074000D000A00090009006400650063006C0061007200650020004000720065007400760061006C0020000900090069006E0074000D000A00090009006400650063006C006100720065002000400049007300440062006F00200009000900090069006E0074000D000A00090009000D000A00090009006400650063006C006100720065002000400055004900440046006F0075006E00640020000900090069006E0074000D000A00090009006400650063006C006100720065002000400044006900610067004900640009000900090069006E0074000D000A00090009006400650063006C0061007200650020004000530068006F0075006C0064004300680061006E0067006500550049004400090069006E0074000D000A0009000D000A000900090069006600280040006400690061006700720061006D006E0061006D00650020006900730020006E0075006C006C0029000D000A000900090062006500670069006E000D000A0009000900090052004100490053004500520052004F00520020002800270049006E00760061006C0069006400200041005200470027002C002000310036002C002000310029000D000A00090009000900720065007400750072006E0020002D0031000D000A000900090065006E0064000D000A0009000D000A000900090065007800650063007500740065002000610073002000630061006C006C00650072003B000D000A0009000900730065006C00650063007400200040007400680065004900640020003D002000440041005400410042004100530045005F005000520049004E0043004900500041004C005F0049004400280029003B00090020000D000A0009000900730065006C006500630074002000400049007300440062006F0020003D002000490053005F004D0045004D0042004500520028004E002700640062005F006F0077006E0065007200270029003B0020000D000A000900090069006600280040006F0077006E00650072005F006900640020006900730020006E0075006C006C0029000D000A00090009000900730065006C00650063007400200040006F0077006E00650072005F006900640020003D0020004000740068006500490064003B000D000A00090009007200650076006500720074003B000D000A0009000D000A0009000900730065006C0065006300740020004000530068006F0075006C0064004300680061006E006700650055004900440020003D00200030000D000A0009000900730065006C006500630074002000400044006900610067004900640020003D0020006400690061006700720061006D005F00690064002C002000400055004900440046006F0075006E00640020003D0020007000720069006E0063006900700061006C005F00690064002000660072006F006D002000640062006F002E007300790073006400690061006700720061006D00730020007700680065007200650020007000720069006E0063006900700061006C005F006900640020003D00200040006F0077006E00650072005F0069006400200061006E00640020006E0061006D00650020003D00200040006400690061006700720061006D006E0061006D00650020000D000A00090009000D000A0009000900690066002800400044006900610067004900640020004900530020004E0055004C004C0020006F00720020002800400049007300440062006F0020003D0020003000200061006E006400200040007400680065004900640020003C003E002000400055004900440046006F0075006E006400290029000D000A000900090062006500670069006E000D000A0009000900090052004100490053004500520052004F0052002000280027004400690061006700720061006D00200064006F006500730020006E006F00740020006500780069007300740020006F007200200079006F007500200064006F0020006E006F0074002000680061007600650020007000650072006D0069007300730069006F006E002E0027002C002000310036002C002000310029003B000D000A00090009000900720065007400750072006E0020002D0033000D000A000900090065006E0064000D000A0009000D000A0009000900690066002800400049007300440062006F0020003C003E002000300029000D000A000900090062006500670069006E000D000A00090009000900690066002800400055004900440046006F0075006E00640020006900730020006E0075006C006C0020006F007200200055005300450052005F004E0041004D0045002800400055004900440046006F0075006E006400290020006900730020006E0075006C006C00290020002D002D00200069006E00760061006C006900640020007000720069006E0063006900700061006C005F00690064000D000A0009000900090062006500670069006E000D000A000900090009000900730065006C0065006300740020004000530068006F0075006C0064004300680061006E006700650055004900440020003D002000310020003B000D000A0009000900090065006E0064000D000A000900090065006E0064000D000A000D000A00090009002D002D0020007500700064006100740065002000640064007300200064006100740061000900090009000D000A00090009007500700064006100740065002000640062006F002E007300790073006400690061006700720061006D0073002000730065007400200064006500660069006E006900740069006F006E0020003D002000400064006500660069006E006900740069006F006E0020007700680065007200650020006400690061006700720061006D005F006900640020003D002000400044006900610067004900640020003B000D000A000D000A00090009002D002D0020006300680061006E006700650020006F0077006E00650072000D000A00090009006900660028004000530068006F0075006C0064004300680061006E006700650055004900440020003D002000310029000D000A000900090009007500700064006100740065002000640062006F002E007300790073006400690061006700720061006D007300200073006500740020007000720069006E0063006900700061006C005F006900640020003D00200040007400680065004900640020007700680065007200650020006400690061006700720061006D005F006900640020003D002000400044006900610067004900640020003B000D000A000D000A00090009002D002D00200075007000640061007400650020006400640073002000760065007200730069006F006E000D000A00090009006900660028004000760065007200730069006F006E0020006900730020006E006F00740020006E0075006C006C0029000D000A000900090009007500700064006100740065002000640062006F002E007300790073006400690061006700720061006D00730020007300650074002000760065007200730069006F006E0020003D0020004000760065007200730069006F006E0020007700680065007200650020006400690061006700720061006D005F006900640020003D002000400044006900610067004900640020003B000D000A000D000A0009000900720065007400750072006E00200030000D000A00090045004E0044000D000A000900, 2, 0, 0, 0, '
	CREATE PROCEDURE dbo.sp_alterdiagram
	(
		@diagramname 	sysname,
		@owner_id	int	= null,
		@version 	int,
		@definition 	varbinary(max)
	)
	WITH EXECUTE AS ''dbo''
	AS
	BEGIN
		set nocount on
	
		declare @theId 			int
		declare @retval 		int
		declare @IsDbo 			int
		
		declare @UIDFound 		int
		declare @DiagId			int
		declare @ShouldChangeUID	int
	
		if(@diagramname is null)
		begin
			RAISERROR (''Invalid ARG'', 16, 1)
			return -1
		end
	
		execute as caller;
		select @theId = DATABASE_PRINCIPAL_ID();	 
		select @IsDbo = IS_MEMBER(N''db_owner''); 
		if(@owner_id is null)
			select @owner_id = @theId;
		revert;
	
		select @ShouldChangeUID = 0
		select @DiagId = diagram_id, @UIDFound = principal_id from dbo.sysdiagrams where principal_id = @owner_id and name = @diagramname 
		
		if(@DiagId IS NULL or (@IsDbo = 0 and @theId <> @UIDFound))
		begin
			RAISERROR (''Diagram does not exist or you do not have permission.'', 16, 1);
			return -3
		end
	
		if(@IsDbo <> 0)
		begin
			if(@UIDFound is null or USER_NAME(@UIDFound) is null) -- invalid principal_id
			begin
				select @ShouldChangeUID = 1 ;
			end
		end

		-- update dds data			
		update dbo.sysdiagrams set definition = @definition where diagram_id = @DiagId ;

		-- change owner
		if(@ShouldChangeUID = 1)
			update dbo.sysdiagrams set principal_id = @theId where diagram_id = @DiagId ;

		-- update dds version
		if(@version is not null)
			update dbo.sysdiagrams set version = @version where diagram_id = @DiagId ;

		return 0
	END
	');
INSERT INTO sys.syscomments (id, number, colid, status, ctext, texttype, language, encrypted, compressed, text) VALUES (1093578934, 1, 1, 0, 0x0D000A0009004300520045004100540045002000500052004F004300450044005500520045002000640062006F002E00730070005F00640072006F0070006400690061006700720061006D000D000A00090028000D000A000900090040006400690061006700720061006D006E0061006D006500200009007300790073006E0061006D0065002C000D000A000900090040006F0077006E00650072005F0069006400090069006E00740009003D0020006E0075006C006C000D000A00090029000D000A00090057004900540048002000450058004500430055005400450020004100530020002700640062006F0027000D000A000900410053000D000A00090042004500470049004E000D000A000900090073006500740020006E006F0063006F0075006E00740020006F006E000D000A00090009006400650063006C006100720065002000400074006800650049006400200009000900090069006E0074000D000A00090009006400650063006C006100720065002000400049007300440062006F00200009000900090069006E0074000D000A00090009000D000A00090009006400650063006C006100720065002000400055004900440046006F0075006E00640020000900090069006E0074000D000A00090009006400650063006C006100720065002000400044006900610067004900640009000900090069006E0074000D000A0009000D000A000900090069006600280040006400690061006700720061006D006E0061006D00650020006900730020006E0075006C006C0029000D000A000900090062006500670069006E000D000A0009000900090052004100490053004500520052004F00520020002800270049006E00760061006C00690064002000760061006C007500650027002C002000310036002C002000310029003B000D000A00090009000900720065007400750072006E0020002D0031000D000A000900090065006E0064000D000A0009000D000A000900090045005800450043005500540045002000410053002000430041004C004C00450052003B000D000A0009000900730065006C00650063007400200040007400680065004900640020003D002000440041005400410042004100530045005F005000520049004E0043004900500041004C005F0049004400280029003B000D000A0009000900730065006C006500630074002000400049007300440062006F0020003D002000490053005F004D0045004D0042004500520028004E002700640062005F006F0077006E0065007200270029003B0020000D000A000900090069006600280040006F0077006E00650072005F006900640020006900730020006E0075006C006C0029000D000A00090009000900730065006C00650063007400200040006F0077006E00650072005F006900640020003D0020004000740068006500490064003B000D000A00090009005200450056004500520054003B0020000D000A00090009000D000A0009000900730065006C006500630074002000400044006900610067004900640020003D0020006400690061006700720061006D005F00690064002C002000400055004900440046006F0075006E00640020003D0020007000720069006E0063006900700061006C005F00690064002000660072006F006D002000640062006F002E007300790073006400690061006700720061006D00730020007700680065007200650020007000720069006E0063006900700061006C005F006900640020003D00200040006F0077006E00650072005F0069006400200061006E00640020006E0061006D00650020003D00200040006400690061006700720061006D006E0061006D00650020000D000A0009000900690066002800400044006900610067004900640020004900530020004E0055004C004C0020006F00720020002800400049007300440062006F0020003D0020003000200061006E0064002000400055004900440046006F0075006E00640020003C003E002000400074006800650049006400290029000D000A000900090062006500670069006E000D000A0009000900090052004100490053004500520052004F0052002000280027004400690061006700720061006D00200064006F006500730020006E006F00740020006500780069007300740020006F007200200079006F007500200064006F0020006E006F0074002000680061007600650020007000650072006D0069007300730069006F006E002E0027002C002000310036002C002000310029000D000A00090009000900720065007400750072006E0020002D0033000D000A000900090065006E0064000D000A0009000D000A0009000900640065006C006500740065002000660072006F006D002000640062006F002E007300790073006400690061006700720061006D00730020007700680065007200650020006400690061006700720061006D005F006900640020003D00200040004400690061006700490064003B000D000A0009000D000A0009000900720065007400750072006E00200030003B000D000A00090045004E0044000D000A000900, 2, 0, 0, 0, '
	CREATE PROCEDURE dbo.sp_dropdiagram
	(
		@diagramname 	sysname,
		@owner_id	int	= null
	)
	WITH EXECUTE AS ''dbo''
	AS
	BEGIN
		set nocount on
		declare @theId 			int
		declare @IsDbo 			int
		
		declare @UIDFound 		int
		declare @DiagId			int
	
		if(@diagramname is null)
		begin
			RAISERROR (''Invalid value'', 16, 1);
			return -1
		end
	
		EXECUTE AS CALLER;
		select @theId = DATABASE_PRINCIPAL_ID();
		select @IsDbo = IS_MEMBER(N''db_owner''); 
		if(@owner_id is null)
			select @owner_id = @theId;
		REVERT; 
		
		select @DiagId = diagram_id, @UIDFound = principal_id from dbo.sysdiagrams where principal_id = @owner_id and name = @diagramname 
		if(@DiagId IS NULL or (@IsDbo = 0 and @UIDFound <> @theId))
		begin
			RAISERROR (''Diagram does not exist or you do not have permission.'', 16, 1)
			return -3
		end
	
		delete from dbo.sysdiagrams where diagram_id = @DiagId;
	
		return 0;
	END
	');
INSERT INTO sys.syscomments (id, number, colid, status, ctext, texttype, language, encrypted, compressed, text) VALUES (1109578991, 0, 1, 0, 0x0D000A0009004300520045004100540045002000460055004E004300540049004F004E002000640062006F002E0066006E005F006400690061006700720061006D006F0062006A0065006300740073002800290020000D000A000900520045005400550052004E005300200069006E0074000D000A00090057004900540048002000450058004500430055005400450020004100530020004E002700640062006F0027000D000A000900410053000D000A00090042004500470049004E000D000A00090009006400650063006C0061007200650020004000690064005F007500700067007200610064006400690061006700720061006D0073000900090069006E0074000D000A00090009006400650063006C0061007200650020004000690064005F007300790073006400690061006700720061006D00730009000900090069006E0074000D000A00090009006400650063006C0061007200650020004000690064005F00680065006C0070006400690061006700720061006D0073000900090069006E0074000D000A00090009006400650063006C0061007200650020004000690064005F00680065006C0070006400690061006700720061006D0064006500660069006E006900740069006F006E00090069006E0074000D000A00090009006400650063006C0061007200650020004000690064005F006300720065006100740065006400690061006700720061006D00090069006E0074000D000A00090009006400650063006C0061007200650020004000690064005F00720065006E0061006D0065006400690061006700720061006D00090069006E0074000D000A00090009006400650063006C0061007200650020004000690064005F0061006C007400650072006400690061006700720061006D002000090069006E00740020000D000A00090009006400650063006C0061007200650020004000690064005F00640072006F0070006400690061006700720061006D000900090069006E0074000D000A00090009006400650063006C006100720065002000400049006E007300740061006C006C00650064004F0062006A006500630074007300090069006E0074000D000A000D000A0009000900730065006C006500630074002000400049006E007300740061006C006C00650064004F0062006A00650063007400730020003D00200030000D000A000D000A0009000900730065006C00650063007400200009004000690064005F007500700067007200610064006400690061006700720061006D00730020003D0020006F0062006A006500630074005F006900640028004E002700640062006F002E00730070005F007500700067007200610064006400690061006700720061006D007300270029002C000D000A000900090009004000690064005F007300790073006400690061006700720061006D00730020003D0020006F0062006A006500630074005F006900640028004E002700640062006F002E007300790073006400690061006700720061006D007300270029002C000D000A000900090009004000690064005F00680065006C0070006400690061006700720061006D00730020003D0020006F0062006A006500630074005F006900640028004E002700640062006F002E00730070005F00680065006C0070006400690061006700720061006D007300270029002C000D000A000900090009004000690064005F00680065006C0070006400690061006700720061006D0064006500660069006E006900740069006F006E0020003D0020006F0062006A006500630074005F006900640028004E002700640062006F002E00730070005F00680065006C0070006400690061006700720061006D0064006500660069006E006900740069006F006E00270029002C000D000A000900090009004000690064005F006300720065006100740065006400690061006700720061006D0020003D0020006F0062006A006500630074005F006900640028004E002700640062006F002E00730070005F006300720065006100740065006400690061006700720061006D00270029002C000D000A000900090009004000690064005F00720065006E0061006D0065006400690061006700720061006D0020003D0020006F0062006A006500630074005F006900640028004E002700640062006F002E00730070005F00720065006E0061006D0065006400690061006700720061006D00270029002C000D000A000900090009004000690064005F0061006C007400650072006400690061006700720061006D0020003D0020006F0062006A006500630074005F006900640028004E002700640062006F002E00730070005F0061006C007400650072006400690061006700720061006D00270029002C0020000D000A000900090009004000690064005F00640072006F0070006400690061006700720061006D0020003D0020006F0062006A006500630074005F006900640028004E002700640062006F002E00730070005F00640072006F0070006400690061006700720061006D00270029000D000A000D000A00090009006900660020004000690064005F007500700067007200610064006400690061006700720061006D00730020006900730020006E006F00740020006E0075006C006C000D000A00090009000900730065006C006500630074002000400049006E007300740061006C006C00650064004F0062006A00650063007400730020003D002000400049006E007300740061006C006C00650064004F0062006A00650063007400730020002B00200031000D000A00090009006900660020004000690064005F007300790073006400690061006700720061006D00730020006900730020006E006F00740020006E0075006C006C000D000A00090009000900730065006C006500630074002000400049006E007300740061006C006C00650064004F0062006A00650063007400730020003D002000400049006E007300740061006C006C00650064004F0062006A00650063007400730020002B00200032000D000A00090009006900660020004000690064005F00680065006C0070006400690061006700720061006D00730020006900730020006E006F00740020006E0075006C006C000D000A00090009000900730065006C006500630074002000400049006E007300740061006C006C00650064004F0062006A00650063007400730020003D002000400049006E007300740061006C006C00650064004F0062006A00650063007400730020002B00200034000D000A00090009006900660020004000690064005F00680065006C0070006400690061006700720061006D0064006500660069006E006900740069006F006E0020006900730020006E006F00740020006E0075006C006C000D000A00090009000900730065006C006500630074002000400049006E007300740061006C006C00650064004F0062006A00650063007400730020003D002000400049006E007300740061006C006C00650064004F0062006A00650063007400730020002B00200038000D000A00090009006900660020004000690064005F006300720065006100740065006400690061006700720061006D0020006900730020006E006F00740020006E0075006C006C000D000A00090009000900730065006C006500630074002000400049006E007300740061006C006C00650064004F0062006A00650063007400730020003D002000400049006E007300740061006C006C00650064004F0062006A00650063007400730020002B002000310036000D000A00090009006900660020004000690064005F00720065006E0061006D0065006400690061006700720061006D0020006900730020006E006F00740020006E0075006C006C000D000A00090009000900730065006C006500630074002000400049006E007300740061006C006C00650064004F0062006A00650063007400730020003D002000400049006E007300740061006C006C00650064004F0062006A00650063007400730020002B002000330032000D000A00090009006900660020004000690064005F0061006C007400650072006400690061006700720061006D00200020006900730020006E006F00740020006E0075006C006C000D000A00090009000900730065006C006500630074002000400049006E007300740061006C006C00650064004F0062006A00650063007400730020003D002000400049006E007300740061006C006C00650064004F0062006A00650063007400730020002B002000360034000D000A00090009006900660020004000690064005F00640072006F0070006400690061006700720061006D0020006900730020006E006F00740020006E0075006C006C000D000A00090009000900730065006C006500630074002000400049006E007300740061006C006C00650064004F0062006A00650063007400730020003D002000400049006E007300740061006C006C00650064004F0062006A00650063007400730020002B0020003100320038000D000A00090009000D000A0009000900720065007400750072006E002000400049006E007300740061006C006C00650064004F0062006A00650063007400730020000D000A00090045004E0044000D000A000900, 2, 0, 0, 0, '
	CREATE FUNCTION dbo.fn_diagramobjects() 
	RETURNS int
	WITH EXECUTE AS N''dbo''
	AS
	BEGIN
		declare @id_upgraddiagrams		int
		declare @id_sysdiagrams			int
		declare @id_helpdiagrams		int
		declare @id_helpdiagramdefinition	int
		declare @id_creatediagram	int
		declare @id_renamediagram	int
		declare @id_alterdiagram 	int 
		declare @id_dropdiagram		int
		declare @InstalledObjects	int

		select @InstalledObjects = 0

		select 	@id_upgraddiagrams = object_id(N''dbo.sp_upgraddiagrams''),
			@id_sysdiagrams = object_id(N''dbo.sysdiagrams''),
			@id_helpdiagrams = object_id(N''dbo.sp_helpdiagrams''),
			@id_helpdiagramdefinition = object_id(N''dbo.sp_helpdiagramdefinition''),
			@id_creatediagram = object_id(N''dbo.sp_creatediagram''),
			@id_renamediagram = object_id(N''dbo.sp_renamediagram''),
			@id_alterdiagram = object_id(N''dbo.sp_alterdiagram''), 
			@id_dropdiagram = object_id(N''dbo.sp_dropdiagram'')

		if @id_upgraddiagrams is not null
			select @InstalledObjects = @InstalledObjects + 1
		if @id_sysdiagrams is not null
			select @InstalledObjects = @InstalledObjects + 2
		if @id_helpdiagrams is not null
			select @InstalledObjects = @InstalledObjects + 4
		if @id_helpdiagramdefinition is not null
			select @InstalledObjects = @InstalledObjects + 8
		if @id_creatediagram is not null
			select @InstalledObjects = @InstalledObjects + 16
		if @id_renamediagram is not null
			select @InstalledObjects = @InstalledObjects + 32
		if @id_alterdiagram  is not null
			select @InstalledObjects = @InstalledObjects + 64
		if @id_dropdiagram is not null
			select @InstalledObjects = @InstalledObjects + 128
		
		return @InstalledObjects 
	END
	');